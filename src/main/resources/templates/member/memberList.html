<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultrag.net.nz/thymeleaf/layout" 
        layout:decorate="~{layouts/basic}"    >
	
	<div layout:fragment="content">
	  	
<!-- 		<div>[[${pageResponseDTO.memberList.size()}]]</div>
	  	<div>[[${pageResponseDTO.memberList}]]</div>
  		<div>[[${pageResponseDTO.total}]]</div>
  		<div>[[${pageResponseDTO}]]</div> -->
<!--	<hr>
	  	<div th:text="${pageResponseDTO.memberList.size()}"></div>
	  	<div th:text="${pageResponseDTO.memberList}"></div>
  		<div th:text="${pageResponseDTO.total}"></div>
  		<div th:text="${pageResponseDTO}"></div> -->
  		
		<h3 class="alert alert-primary">회원 목록 조회</h3>
		
		<!-- 검색 기능: PageRequestDTO객체 속성과 동일한 이름로 매개변수 설정 -->
		<!-- PageRequestDTO와 search form 매개변수 1:1 자동맵핑 -->
		<!--  :  types, keyword, from, to -->
		<form   id="searchForm">
			
			<div class="row m-2">
				<!--  th:with="변수=데이터,수식결과 등" -->
				<div th:with="isChecked=${pageRequestDTO.checkType('i')}" 
					 class="form-check col-1 me-2">
				  <input class="form-check-input" type="checkbox" 
				  		th:value="i" id="id" name="types"
				  		th:attrappend="checked=${isChecked?'checked':''}"
				  		>
				  <label class="form-check-label"  for="flexCheckDefault">
				   아이디
				   <!-- [[${isChecked}]]	 -->		  
				   </label>
				</div>
				<!-- th:attr="checked=${pageRequestDTO.checkType2('i')?'checked':''}"> -->
				<div th:with="isChecked=${pageRequestDTO.checkType('n')}" 
					class="form-check col-1 me-2">
				  <input class="form-check-input" type="checkbox" 
				  		th:value="n" id="name" name="types" 
				  		th:attrappend="checked=${isChecked?'checked':''}"
				  		>
				  <label class="form-check-label" for="flexCheckChecked">
				   이름 
				  <!--  [[${isChecked}]] -->
				  </label>
				</div>				
			</div>
			
			<div>
				<div class="m-2">
					<input class="form-control me-2" 
							type="search" 
							name="keyword" th:value="${pageRequestDTO.keyword}"
							placeholder="Search" aria-label="Search">
							
				</div>
				
				<div class="row g-4 m-2">
					<div class="col-5">
						<input class="form-control me-2" type="date" name="from" th:value="${pageRequestDTO.from }" />
					</div>
					<div class="col-5">
						<input class="form-control me-2" type="date" name="to" th:value="${pageRequestDTO.to }" />
					</div>
								
					<div class="col-2">
						<button type="submit" class="btn btn-outline-success">Search</button>
						<button type="reset" id="reset" class="btn btn-outline-info">Clear</button>
					</div>	
				</div>
		
			</div>
			

		</form>
		

		
		<hr>
		<div>
			<table class="table table-bordered ">
			  <thead>
			    <tr>
			      <th scope="col">NO</th>
			      <th scope="col">아이디</th>
			      <th scope="col">이름</th>
			      <th scope="col">이메일</th>
			      <th scope="col">등록일자</th>
			    </tr>
			  </thead>
			  <tbody>

			    <tr th:each="member : ${pageResponseDTO.memberList }" >
			      <td th:text="${member.recnum}"></td>
			      <td scope="row">
			      	<!-- <a th:href="@{/}"  
			      		th:class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover">
			      		[[${member.id}]]</a> -->
			      		<a href="#" 
			      			class="link-secondary link-offset-2 link-underline-opacity-25 link-underline-opacity-100-hover"
					       th:href="@{/member/view(id=${member.id})}" >[[${member.id}]]</a>
			      		
			      </td>
			      <td>[[${member.name}]]</td>
			      <td >[[${member.email}]]</td>
			      <td>[[${member.joinDate}]]</td>
			    </tr>
			  </tbody>
			</table>			
		</div>
		
		<!--  페이징 네비게이션  -->
				
		<div class="d-flex justify-content-between mt-4" >
			<div><!--  버튼 -->
				<button type="button" class="btn btn-success btn-sm"
						onclick="register();">회원가입</button>
			</div>
			<div><!-- 네비게이션 -->
				<nav aria-label="...">
				  <ul class="pagination">
				  
				   <!-- 첫번째 블럭(시작페이지 번호가 1이면 비활성화 -->
				    <li th:if="${pageResponseDTO.prev} == true" class="page-item">
				      <a class="page-link" th:data-num="${pageResponseDTO.start-1}">이전</a>
				    </li>
				   
				    
				    <!--  해당 블럭의 시작 페이지 번호와 마지막번호 -->
				    <th:block th:each="i : ${#numbers.sequence(pageResponseDTO.start,pageResponseDTO.end)}">
				    <li class="page-item  ${pageResponseDTO.page == i  ? 'active' : '' }">
				    	<a class="page-link" th:data-num="${i}">[[${i}]]</a>
				    </li>
				    </th:block>
				  
				    
				    <!-- 마지막번째 블럭이면 next버튼 비활성화 -->
				    <li th:if="${pageResponseDTO.next} == true"  class="page-item">
				      <a class="page-link" href="#" th:data-num="${pageResponseDTO.end+1}">다음</a>
				    </li>
				    
				  </ul>			
				 </nav>
			</div>
		</div>
		
		

	   
	</div>










   <!-- 내보내기 기능 역할 -->
   <!--  현재 페이지에만 적용되는 css인 경우 -->
   <style layout:fragment="css" th:inline="css">
   		.test { color: red;}
   </style>
   
   <!--  현재 페이지에만 적용되는 script인 경우 -->
   <script layout:fragment="script" th:inline="javascript">
   
	/* javascript , jQuery Test 
	console.log("inline javascript test !!!")
   	$(function(){	console.log('jQuery Ok...') }); */
   	

   	
 // javascript 
	document.querySelector(".pagination").addEventListener('click', (e)=>{
		e.preventDefault();
		e.stopPropagation();// 현재 이벤트가 발생시 상위요소에서 이벤트감지를 막음
		
		const target = e.target;// 실제 이벤트가 발생 태그 요소의 객체 주소을 넘겨받음
		if (target.tagName !== 'A') return;
		
		const page_num = target.getAttribute('data-num');// 선택 태그의 페이지 번호
		//console.log("data_num: ", page_num)
		//alert('click event :  '+  page_num)
		
		const formObj = document.querySelector("#searchForm");
		formObj.innerHTML += '<input type="hidden" name="page" value="'+ page_num + '">'  // 또는;
		//formObj.innerHTML += '<input type="hidden" name="page" value="'+ page_num + '">'
		//formObj.innerHTML += `<input type="hidden" name="page" value=\'${page_num}' > `;  // =>

		formObj.method = 'get';
		formObj.action = "/member/list";
		formObj.submit();
		


		
		
	});
   	
   	
   </script>
   

</html>
